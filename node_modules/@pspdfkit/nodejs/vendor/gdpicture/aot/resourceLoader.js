/*!
 * PSPDFKit for Node.js 0.0.3 (https://pspdfkit.com/nodejs)
 *
 * Copyright (c) 2023 PSPDFKit GmbH. All rights reserved.
 *
 * THIS SOURCE CODE AND ANY ACCOMPANYING DOCUMENTATION ARE PROTECTED BY INTERNATIONAL COPYRIGHT LAW
 * AND MAY NOT BE RESOLD OR REDISTRIBUTED. USAGE IS BOUND TO THE PSPDFKIT LICENSE AGREEMENT.
 * UNAUTHORIZED REPRODUCTION OR DISTRIBUTION IS SUBJECT TO CIVIL AND CRIMINAL PENALTIES.
 * This notice may not be removed from this file.
 *
 * PSPDFKit uses several open source third-party components: https://pspdfkit.com/acknowledgements/nodejs/
 */
let require,resources;let ENVIRONMENT_IS_NODE="string"==typeof globalThis.process?.versions?.node,ENVIRONMENT_IS_DENO="object"==typeof window&&"Deno"in window||"object"==typeof self&&"Deno"in self;export async function initialize(){if(ENVIRONMENT_IS_NODE){let{createRequire:e}=await import("module");require=e(import.meta.url)}else if(ENVIRONMENT_IS_DENO){let e=(await import("./resources/list.json",{assert:{type:"json"}})).default,r=await Promise.all(e.map(e=>{let r=new URL(`./resources/${e}`,import.meta.url);return globalThis.fetch(r).then(async e=>{if(e.ok)return e.arrayBuffer()}).then(r=>({buffer:r,filename:e})).catch(()=>({buffer:void 0,filename:e}))}));resources=r.reduce((e,{filename:r,buffer:t})=>(e[`${globalThis.gdPicture.baseUrl}/resources/${decodeURI(r)}`]=t,e),{})}}export function fetchResource(e,r){fetch(`${globalThis.gdPicture.baseUrl}/resources/${e}`,r)}export function fetch(e,r){try{if(ENVIRONMENT_IS_NODE){let t=require("node:fs"),o=require("node:path"),i=t.readFileSync(o.normalize(e));globalThis.gdPicture.module.FS.writeFile(r,new Uint8Array(i))}else if(ENVIRONMENT_IS_DENO)globalThis.gdPicture.module.FS.writeFile(r,new Uint8Array(resources[e]));else{let t=new XMLHttpRequest;t.open("GET",e,!1),t.overrideMimeType("text/plain; charset=x-user-defined"),t.send(),200===t.status?globalThis.gdPicture.module.FS.writeFile(r,stringToArrayBuffer(t.response)):console.error(`Could not retrieve resource. Status: ${t.status}`)}}catch(e){console.error(`Could not retrieve resource. Exception: ${e}`)}}function stringToArrayBuffer(e){let r=new ArrayBuffer(e.length),t=new Uint8Array(r);for(let r=0,o=e.length;r<o;r++)t[r]=e.charCodeAt(r);return t}